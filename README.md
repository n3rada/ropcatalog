
`ropcatalog` is a Python tool designed for parsing and analyzing [ROP (Return-Oriented Programming)](https://en.wikipedia.org/wiki/Return-oriented_programming) gadgets extracted from [rp++](https://github.com/0vercl0k/rp) output files. It helps identify, classify, and filter useful ROP gadgets.

It was built during OffSec journey. Primarly for [EXP-301 course](https://www.offsec.com/courses/exp-301/) and then [EXP-401](https://www.offsec.com/courses/exp-401/). These courses focuses on Windows exploit development.

## Installation

Designed for simplicity, using `pipx` for isolation:

```shell
pipx install 'git+https://github.com/n3rada/ropcatalog.git'
```

Then, you can use `ropcatalog` to help you leaf through the gadget catalog:
```shell
ropcatalog ~/dump/libeay32IBM019.txt
```

## Quickstart

Dump gadgets using `rp++`:

```shell
.\rp-win.exe -f "C:\Program Files\ibm\gsk8\lib\N\icc\osslib\libeay32IBM019.dll" --va=0 -r 5 > libeay32IBM019.txt
```
Then, open your catalog with ASLR considerations (`--offset`) and output unique (`-u`) addresses in a copy-pastable Python format (`-s`):
```shell
ropcatalog ~/dump/libeay32IBM019.txt -b "\x00\x09\x0a\x0b\x0c\x0d\x20" -u -o -s python
```

If you forgot how to browse your own catalog, use `help`

Now, you can search for any gadget that copies the stack pointer (`ESP`) register to another register:
![copy_esp_ASLR](./images/copy_esp_ASLR.png)


Without offset considerations, you can search inside any module for gadgets that dereference `ESI`:
![deref_esi](./images/deref_esi.png)


Without using the Python copy-paste format, you can search for gadgets that zero `EAX`:
![zero_eax](./images/zero_eax.png)

## Command Reference

```txt
usage: catalog [-h] [-b BAD_CHARACTERS] [-u] [-s {plain,python,js}] [-o] paths [paths ...]

r++ gadget parser for specific instructions.

positional arguments:
  paths                 Paths to one or more ROP files generated by r++. Directory also accepted.

options:
  -h, --help            show this help message and exit
  -b BAD_CHARACTERS, --bad-characters BAD_CHARACTERS
                        A string of characters to exclude in the format '\x00\x0a\x0d'.
  -u, --unique          Filter for unique gadgets by their raw instruction sequences.
  -s {plain,python,js}, --style {plain,python,js}
                        Output format style: plain, python, or js.
  -o, --offset          The file contains only the offset (e.g., ALSR case).
```

Below are the commands available from the terminal.

### üîß General Commands

| Command | Description | Example |
|---------|-------------|---------|
| `help` | Show categorized command list | `help` |
| `list` | Display all loaded gadgets | `list` |
| `uniq` | Toggle uniqueness filtering | `uniq on` / `uniq` |
| `exit` | Exit ropcatalog | `exit` |

### üîé Search Commands
| Command | Description | Example |
|---------|-------------|---------|
| `?` | Exact instruction match | `? pop eax ; ret` |
| `/` | Partial instruction match | `/ pop` |
| `.` | Regex search | `. mov.*rax.*0x` |
| `memoff` | Memory offset dereference | `memoff rbx+0x20` |

### üìù Register Operations
| Command | Description | Example |
|---------|-------------|---------|
| `copy` | Copy register to another | `copy rax` |
| `copyto` | Copy into specific register | `copyto r9` |
| `save` | Save register (no modifications) | `save rbx` |
| `swap` | Exchange registers | `swap eax` |
| `zero` | Zero a register | `zero rcx` |
| `inc` | Increment register | `inc edx` |
| `dec` | Decrement register | `dec eax` |

### üíæ Memory Operations
| Command | Description | Example |
|---------|-------------|---------|
| `read` | Read from memory | `read rbx` ‚Üí `mov rax, [rbx]` |
| `write` | Write to memory | `write rcx` ‚Üí `mov [rax], rcx` |
| `deref` | Alias for `read` | `deref rsi` |

### üìö Stack Operations
| Command | Description | Example |
|---------|-------------|---------|
| `push` | Push register to stack | `push rax` |
| `pop` | Pop from stack to register | `pop rbx` |
| `ppr` | Find pop-pop-ret sequences | `ppr` |
| `pivot` | Stack pivot gadgets | `pivot imm` / `pivot reg` |

### üéØ Control Flow
| Command | Description | Example |
|---------|-------------|---------|
| `jump` | Jump gadgets | `jump esp` |
| `call` | Indirect call gadgets | `call rax` |